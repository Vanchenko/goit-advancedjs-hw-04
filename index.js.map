{"version":3,"file":"index.js","sources":["../src/js/refs.js","../src/js/requestOptions.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default {\n    lmBtnEl : document.querySelector('.return-begin'),\n    galleryEl : document.querySelector('.gallery'),\n    srhFormEl: document.querySelector('#search-form'),\n    foundPict: document.querySelector('#found-pictures'),\n    loadPict: document.querySelector('#load-pictures'),\n    currentPage: document.querySelector('#current-page'),\n    spinner: document.querySelector('.loader'),\n} \n","export const URL = 'https://pixabay.com/api/';\nexport const options = {\n    params: {\n        key: '35244614-3f1384186f27e7cacc119fb8b',\n        page: 1,\n        per_page: 50,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n    }\n}\n","import axios from 'axios';\nimport { URL, options } from \"./requestOptions\";\n\nexport const loadPictures = async () => {\n    const pictures = await axios.get(URL, options);\n    return pictures;\n};","import refs from \"./refs\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet gallery = new SimpleLightbox('.gallery a', {\n    enableKeyboard: true,\n    captionPosition: 'bottom',\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionDelay: 250,\n    showCounter: false,\n});\n\nexport function renderGallery(pictures) {\n    let markUp = \"\";\n    markUp = pictures.data.hits.map((elem) => `<div class=\"photo-card\">\n            <a class=\"gallery link\" href=\"${elem.largeImageURL}\">\n                <img src=\"${elem.webformatURL}\" alt=\"${elem.tags}\" width=\"360\" height=\"200\" loading=\"lazy\"/> \n            </a>\n            <ul class=\"info\">\n                <li class=\"info-item\">\n                    <b>Likes</b>\n                    <p>${elem.likes}</p>\n                </li>\n                <li class=\"info-item\">\n                    <b>Views</b>\n                    <p>${elem.views}</p>\n                </li>\n                <li class=\"info-item\">\n                    <b>Comments</b>\n                    <p>${elem.comments}</p>\n                </li>\n                <li class=\"info-item\">\n                    <b>Downloads</b>\n                    <p>${elem.downloads}</p>\n                </li>\n            </ul>\n            </div>`).join(\"\");\n    refs.galleryEl.insertAdjacentHTML(\"beforeend\", markUp);\n    gallery.refresh();\n\n   // observer.observe(refs.galleryEl.lastChild);\n}\n\nexport function renderInfoline(qqpict, pictTotal, page) {\n    refs.foundPict.style.display = \"flex\";\n    refs.loadPict.style.display = \"flex\";\n    refs.currentPage.style.display = \"flex\";\n    refs.foundPict.textContent = `Found pictures :${qqpict}`;\n    refs.loadPict.textContent = `Load pictures :${pictTotal}`;\n    refs.currentPage.textContent = `Page :${page}`;\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport refs from './js/refs';\nimport { options } from \"./js/requestOptions\";\nimport { loadPictures } from './js/pixabay-api';\nimport { renderGallery, renderInfoline } from './js/render-functions';\n\nrefs.lmBtnEl.style.display = \"none\";\nrefs.foundPict.style.display = \"none\";\nrefs.loadPict.style.display = \"none\";\nrefs.currentPage.style.display = \"none\";\nrefs.spinner.style.display = \"none\";\nlet page = 1;\nlet pictTotal = 0;\nlet totalHits = 0;\nconst per_page = options.params.per_page;\n\nconst optionsScroll = {\n    root: null,\n    rootMargin: '300px',\n    threshold: 1.0,\n}\nconst callback = function (entries, observer) {\n    if (entries[0].isIntersecting && totalHits > pictTotal ) {\n        page += 1;\n        options.params.page = page;\n        observer.disconnect();\n        refs.spinner.style.display = \"inline-block\";\n        loadPictures()\n            .then((pictures) => {\n                pictTotal = pictTotal + pictures.data.hits.length;\n                renderGallery(pictures);\n                renderInfoline(pictures.data.totalHits, pictTotal, page);\n                observer.observe(refs.galleryEl.lastElementChild);\n            }).catch((error) => {\n                console.log(error.response);\n            }).finally(() => {\n            refs.spinner.style.display = \"none\";\n        });\n    } else { \n          if (totalHits <= pictTotal) {\n                        observer.disconnect();\n                        if (totalHits > per_page) { \n                            refs.lmBtnEl.style.display = \"flex\";\n                            iziToast.show({message:\"We're sorry, but you've reached the last page of search results.\",\n                                position: 'topRight',\n                                backgroundColor: 'red',\n                                messageColor: 'white',\n                            });\n                             };\n                        \n                    }; };\n};\nconst observer = new IntersectionObserver(callback, optionsScroll);\n\nrefs.srhFormEl.addEventListener(\"submit\", (event) => {  \n    event.preventDefault();\n    options.params.q = (refs.srhFormEl.elements[0].value).trim();\n    if (options.params.q === \"\") {\n        console.log(\"return\");\n        event.currentTarget.reset();\n        return\n    };\n    event.currentTarget.reset();\n    page = 1;\n    options.params.page = page;\n    pictTotal = 0;\n    refs.lmBtnEl.style.display = \"none\";\n    refs.srhFormEl.children[1].setAttribute('disabled', 'true');\n    refs.galleryEl.innerHTML = \"\";\n    refs.foundPict.style.display = \"none\";\n    refs.loadPict.style.display = \"none\";\n    refs.currentPage.style.display = \"none\";\n    refs.spinner.style.display = \"inline-block\";\n  \n    loadPictures()\n        .then((pictures) => {\n            if (pictures.data.hits.length > 0) {\n                iziToast.show({ message: `Hooray! We found ${pictures.data.totalHits} images.`, \n                        position: 'topRight',\n                        backgroundColor: 'blue',\n                        messageColor: 'white',\n                })\n                refs.spinner.style.display = \"none\";\n                totalHits = pictures.data.totalHits;\n                renderGallery(pictures);\n                pictTotal = pictTotal + pictures.data.hits.length;\n                renderInfoline(pictures.data.totalHits, pictTotal, page);\n                observer.observe(refs.galleryEl.lastElementChild);\n\n            }\n            else { iziToast.show({message:`Sorry, there are no images matching your search query: \"${options.params.q}\". Please try again!`,\n                position: 'topRight',\n                backgroundColor: 'red',\n                messageColor: 'white',\n            }) };\n        }).catch((error) => {\n            console.log(error);\n        }).finally(() => {\n            setTimeout(() => { refs.srhFormEl.children[1].removeAttribute('disabled'); }, 3000);\n            refs.spinner.style.display = \"none\";\n        });\n});\n\nrefs.lmBtnEl.addEventListener(\"click\", () => {\n    window.scroll(0,0);\n});"],"names":["refs","URL","options","loadPictures","axios","gallery","SimpleLightbox","renderGallery","pictures","markUp","elem","renderInfoline","qqpict","pictTotal","page","totalHits","per_page","optionsScroll","callback","entries","observer","error","iziToast","event"],"mappings":"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"}