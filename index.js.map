{"version":3,"file":"index.js","sources":["../src/js/refs.js","../src/js/requestOptions.js","../src/js/loadPictures.js","../src/js/renderGallery.js","../src/main.js"],"sourcesContent":["export default {\n    lmBtnEl : document.querySelector('.load-more'),\n    galleryEl : document.querySelector('.gallery'),\n    srhFormEl: document.querySelector('#search-form'),\n    foundPict: document.querySelector('#found-pictures'),\n    loadPict: document.querySelector('#load-pictures'),\n    spinner: document.querySelector('.loader'),\n} \n","export const URL = 'https://pixabay.com/api/';\nexport const options = {\n    params: {\n        key: '35244614-3f1384186f27e7cacc119fb8b',\n        page: 1,\n        per_page: 50,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n    }\n}\n","import axios from 'axios';\nimport { URL, options } from \"./requestOptions\";\n\nexport const loadPictures = async () => {\n    const pictures = await axios.get(URL, options);\n    return pictures;\n};","import refs from \"./refs\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet gallery = new SimpleLightbox('.gallery a', {\n    enableKeyboard: true,\n    captionPosition: 'bottom',\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionDelay: 250,\n    showCounter: false,\n});\n\nexport function renderGallery(pictures) {\n    let markUp = \"\";\n    markUp = pictures.data.hits.map((elem) => `<div class=\"photo-card\">\n            <a class=\"gallery link\" href=\"${elem.largeImageURL}\">\n            <img src=\"${elem.webformatURL}\" alt=\"${elem.tags}\" width=\"250\" height=\"200\" loading=\"lazy\"/> \n            </a>\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes ${elem.likes}</b>\n                </p>\n                <p class=\"info-item\">\n                    <b>Views ${elem.views}</b>\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments ${elem.comments}</b>\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads ${elem.downloads}</b>\n                </p>\n            </div>\n            </div>`).join(\"\");\n    refs.galleryEl.style.display = \"flex\";\n    refs.galleryEl.style.flexWrap = \"wrap\";\n    refs.galleryEl.style.justifyContent = \"center\";\n    refs.galleryEl.insertAdjacentHTML(\"beforeend\", markUp);\n    gallery.refresh();\n\n   // observer.observe(refs.galleryEl.lastChild);\n}\n\nexport function renderInfoline(qqpict, pictTotal) {\n    refs.foundPict.style.display = \"flex\";\n    refs.loadPict.style.display = \"flex\";\n    refs.foundPict.textContent = `Found pictures :${qqpict}`;\n    refs.loadPict.textContent = `Load pictures :${pictTotal}`;\n}","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport refs from './js/refs';\nimport { options } from \"./js/requestOptions\";\nimport { loadPictures } from './js/loadPictures';\nimport { renderGallery, renderInfoline } from './js/renderGallery';\n\nrefs.lmBtnEl.style.display = \"none\";\nrefs.foundPict.style.display = \"none\";\nrefs.loadPict.style.display = \"none\";\nrefs.spinner.style.display = \"none\";\nlet page = 1;\nlet pictTotal = 0;\nconst per_page = options.params.per_page;\n\nconst optionsScroll = {\n    root: null,\n    rootMargin: '300px',\n    threshold: 1.0,\n}\nconst callback = function (entries, observer) {\n    if (entries[0].isIntersecting) {\n        page += 1;\n        options.params.page = page;\n        observer.disconnect();\n        // refs.spinner.style.display = \"inline-block\";\n        loadPictures()\n            .then((pictures) => {\n                pictTotal = pictTotal + pictures.data.hits.length;\n                    if (pictures.data.totalHits < pictTotal) {\n                        if (pictures.data.totalHits > per_page) { refs.lmBtnEl.style.display = \"flex\" };\n                        iziToast.show({message:\"We're sorry, but you've reached the end of search results.\",\n                            position: 'topCenter',\n                        });\n                        return\n                    };\n                renderGallery(pictures);\n                renderInfoline(pictures.data.totalHits, pictTotal);\n                observer.observe(refs.galleryEl.lastChild);\n            }).catch((error) => {\n                console.log(error.response);\n            });\n    }\n};\nconst observer = new IntersectionObserver(callback, optionsScroll);\n\nrefs.srhFormEl.addEventListener(\"submit\", (event) => {  \n    event.preventDefault();\n    options.params.q = (refs.srhFormEl.elements[0].value).trim();\n    if (options.params.q === \"\") {\n        console.log(\"return\");\n        event.currentTarget.reset();\n        return\n    };\n    event.currentTarget.reset();\n    page = 1;\n    options.params.page = page;\n    pictTotal = 0;\n    refs.lmBtnEl.style.display = \"none\";\n    refs.srhFormEl.children[1].setAttribute('disabled', 'true');\n    refs.galleryEl.innerHTML = \"\";\n    refs.foundPict.style.display = \"none\";\n    refs.loadPict.style.display = \"none\";\n    refs.spinner.style.display = \"inline-block\";\n  \n    // console.log(\"Search:\", options.params.q);\n    loadPictures()\n        .then((pictures) => {\n            if (pictures.data.hits.length > 0) {\n                iziToast.show({ message: `Hooray! We found ${pictures.data.totalHits} images.`, \n                        position: 'topCenter',\n                })\n                refs.spinner.style.display = \"none\";\n                renderGallery(pictures);\n                pictTotal = pictTotal + pictures.data.hits.length;\n                renderInfoline(pictures.data.totalHits, pictTotal);\n                observer.observe(refs.galleryEl.lastChild);\n\n            }\n            else { iziToast.show({message:`Sorry, there are no images matching your search query: \"${options.params.q}\".`,\n                position: 'topCenter',\n            }) };\n        }).catch((error) => {\n            console.log(error);\n        }).finally(() => {\n            setTimeout(() => { refs.srhFormEl.children[1].removeAttribute('disabled'); }, 3000);\n        });\n});\n\nrefs.lmBtnEl.addEventListener(\"click\", () => {\n    window.scroll(0,0);\n});"],"names":["refs","URL","options","loadPictures","axios","gallery","SimpleLightbox","renderGallery","pictures","markUp","elem","renderInfoline","qqpict","pictTotal","page","per_page","optionsScroll","callback","entries","observer","iziToast","error","event"],"mappings":"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"}